(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,e,n){t.exports=n(30)},19:function(t,e,n){},22:function(t,e,n){},3:function(t,e,n){"use strict";(function(t){n.d(e,"c",function(){return o}),n.d(e,"a",function(){return u}),n.d(e,"b",function(){return p});var r=n(1),a=n.n(r),c=n(2),i=12;function o(){return s.apply(this,arguments)}function s(){return(s=Object(c.a)(a.a.mark(function e(){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=window.location.hash.substring(1,window.location.hash.length-1),r=t.from(n,"base64"),e.next=5,window.crypto.subtle.importKey("raw",r,{name:"AES-GCM"},!1,["encrypt","decrypt"]);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}function u(t,e){return l.apply(this,arguments)}function l(){return(l=Object(c.a)(a.a.mark(function e(n,r){var c,o,s,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.from(r,"base64"),o=c.subarray(0,i),s=c.subarray(i),e.t0=t,e.next=6,window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},n,s);case 6:return e.t1=e.sent,u=e.t0.from.call(e.t0,e.t1).toString("utf-8"),e.abrupt("return",u);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function p(t,e){return d.apply(this,arguments)}function d(){return(d=Object(c.a)(a.a.mark(function t(e,n){var r,c,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=window.crypto.getRandomValues(new Uint8Array(i)),t.next=3,window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,(new TextEncoder).encode(n));case 3:return c=t.sent,o=m(r,c),s=f(o),t.abrupt("return",s);case 7:case"end":return t.stop()}},t)}))).apply(this,arguments)}function m(t,e){var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer}function f(t){for(var e=new Uint8Array(t),n="",r=e.byteLength,a=0;a<r;a++)n+=String.fromCharCode(e[a]);return window.btoa(n)}}).call(this,n(25).Buffer)},30:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(6),i=n.n(c),o=(n(19),n(1)),s=n.n(o),u=n(2),l=n(7),p=n(8),d=n(13),m=n(12),f=n(4),h=(n(22),n(23),n(9)),w=n.n(h),b=n(10),y=n(11),v=n.n(y),E=n(3);function x(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(f.a)(t);if(e){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}function g(t){return a.a.createElement("div",{className:"flexnowrap"},a.a.createElement("div",{className:"led led-".concat(t.color)}),a.a.createElement("div",null,t.text))}function k(t){return a.a.createElement("div",{id:"top"},a.a.createElement("a",{href:"https://github.com/cs01/termpair"},a.a.createElement("img",{height:"30px",src:w.a,alt:"logo"})))}function j(t){return a.a.createElement("div",{id:"statusbar"}," ",a.a.createElement("div",null,"connected"===t.status?a.a.createElement(g,{color:"green",text:t.status}):a.a.createElement(g,{color:"red",text:t.status})),a.a.createElement("div",null,t.terminalData.allow_browser_control&&"connected"===t.status?a.a.createElement(g,{color:"green",text:"can type"}):a.a.createElement(g,{color:"orange",text:"cannot type"})),a.a.createElement("div",null,t.terminalData.num_clients?t.terminalData.num_clients:"0"," ","Connected Clients"),a.a.createElement("div",null,"Started at"," ",v()(t.terminalData.broadcast_start_time_iso).format("h:mm:ss a on MMM Do YYYY")))}function O(){return a.a.createElement("div",{id:"bottom"},a.a.createElement("div",null,"A ",a.a.createElement("a",{href:"https://grassfedcode.com"},"Chad Smith")," project"),a.a.createElement("div",null,a.a.createElement("a",{href:"https://github.com/cs01"},"GitHub")),a.a.createElement("div",null,a.a.createElement("a",{href:"https://twitter.com/grassfedcode"},"Twitter")))}function _(t){t.writeln("To broadcast a terminal, run");var e="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.pathname);t.writeln(""),t.writeln('    pipx run termpair share --host "'.concat(e,'"')),t.writeln(""),t.writeln("Then open or share the url printed to the terminal."),t.writeln("To install pipx, see https://pipxproject.github.io/pipx/"),t.writeln("All terminal data is end-to-end encrypted \ud83d\udd12."),t.writeln("The termpair server and third parties can't read transmitted data.")}var S=function(t){Object(d.a)(n,t);var e=x(n);function n(t){var r;Object(l.a)(this,n),r=e.call(this,t);var c=new URLSearchParams(window.location.search).get("terminal_id"),i=null!=window.crypto;r.state={terminalData:{},terminalId:c,hasCrypto:i,status:c&&i?"connection-pending":"disconnected",num_clients:null,secretEncryptionKey:"pending"},r.xterm=new b.Terminal({cursorBlink:!0,macOptionIsMeta:!0,scrollback:1e3}),r.terminalRef=a.a.createRef();return r.xterm.resize(90,20),r}return Object(p.a)(n,[{key:"render",value:function(){return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(k,Object.assign({},this.props,this.state)),a.a.createElement("div",{id:"terminal",ref:this.terminalRef.current}),this.state.terminalId?a.a.createElement(j,Object.assign({},this.props,this.state)):null,a.a.createElement(O,null))}},{key:"componentDidMount",value:function(){var t=Object(u.a)(s.a.mark(function t(){var e,n,r,a,c,i,o,l=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=function(){return(o=Object(u.a)(s.a.mark(function t(r){var a,c,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("new_output"!==(a=JSON.parse(r.data)).event){t.next=9;break}return c=a.payload,t.next=5,Object(E.a)(n,c);case 5:i=t.sent,e.writeUtf8(i),t.next=10;break;case 9:"resize"===a.event?(clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.resize(a.payload.cols,a.payload.rows)},500)):"num_clients"===a.event?(this.state.terminalData.num_clients=a.payload,this.setState({terminalData:this.state.terminalData})):console.error("unknown event type",a);case 10:case"end":return t.stop()}},t,this)}))).apply(this,arguments)},i=function(t){return o.apply(this,arguments)},e=this.xterm,t.next=5,Object(E.c)();case 5:return n=t.sent,this.setState({secretEncryptionKey:n}),t.next=9,fetch("terminal/".concat(this.state.terminalId));case 9:return t.next=11,t.sent.json();case 11:if(r=t.sent,this.setState({terminalData:r}),e.open(document.getElementById("terminal")),e.writeln("Welcome to TermPair! https://github.com/cs01/termpair"),e.writeln(""),r.terminal_id){t.next=21;break}return _(e),t.abrupt("return");case 21:if(n){t.next=26;break}return _(e),t.abrupt("return");case 26:if(this.state.hasCrypto){t.next=30;break}return e.writeln("TermPair only works on secure connections."),_(e),t.abrupt("return");case 30:a="https:"===window.location.protocol?"wss":"ws",c=new WebSocket("".concat(a,"://").concat(window.location.hostname,":").concat(window.location.port).concat(window.location.pathname,"connect_browser_to_terminal?terminal_id=").concat(this.state.terminalId)),e.onKey(function(){var t=Object(u.a)(s.a.mark(function t(e,r){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=c,t.next=3,Object(E.b)(n,e.key);case 3:t.t1=t.sent,t.t0.send.call(t.t0,t.t1);case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),c.addEventListener("open",function(t){l.setState({status:"connected"}),e.writeln("Connection established with end-to-end encryption \ud83d\udd12."),e.writeln("The termpair server and third parties can't read transmitted data.")}),c.addEventListener("close",function(t){"connected"===l.state.status?e.writeln("Connection ended"):e.writeln("Failed to establish connection. Ensure you have a valid url."),_(e),l.setState({status:"disconnected"}),l.setState({num_clients:0})}),c.addEventListener("message",i.bind(this));case 36:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),n}(r.Component);i.a.render(a.a.createElement(S,null),document.getElementById("root"))},9:function(t,e,n){t.exports=n.p+"static/media/logo.74cdedb8.png"}},[[14,1,2]]]);
//# sourceMappingURL=main.e12d8782.chunk.js.map