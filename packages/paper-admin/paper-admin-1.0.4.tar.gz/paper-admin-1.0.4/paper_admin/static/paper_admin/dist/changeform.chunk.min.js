(self.webpackChunkpaper_admin=self.webpackChunkpaper_admin||[]).push([[10],{9063:function(t,e,o){"use strict";o.r(e);var n=o(7978),i=o(2948),s=o(6837),r=o(5716),a=o(9127),l=o(8948);function d(t){this.element=t}function c(t,e){if(this.opts=Object.assign({prefix:"form",addButtonSelector:".add-row",deleteButtonSelector:".delete-row",formCssClass:"inline-related",emptyCssClass:"empty-form",animationSpeed:300,onAdded:null,onRemove:null},e),this.root=t,this.root._inline_formset=this,this.mgmt=new d(t),this.addButton=this.root.querySelector(this.opts.addButtonSelector),!this.addButton)throw new Error("addButton not found");this.addButton.hidden=this.mgmt.totalForms()>=this.mgmt.maxForms(),this.addButton.querySelector("a, button").addEventListener("click",function(t){t.preventDefault(),this.addRow()}.bind(this));const o=this;this.root.addEventListener("click",(function(t){const e=t.target;if(e.closest(o.opts.deleteButtonSelector)){t.preventDefault();const n=e.closest("."+o.opts.formCssClass);o.deleteRow(n)}}))}function u(t,e,o){const n=new RegExp("("+e+"-(\\d+|__prefix__))"),i=e+"-"+(o-1);t.querySelectorAll("*").forEach((function(t){t.htmlFor&&(t.htmlFor=t.htmlFor.replace(n,i)),t.id&&(t.id=t.id.replace(n,i)),t.name&&(t.name=t.name.replace(n,i))})),t.setAttribute("id",e+"-"+(o-1))}function p(t,e){const o=t.querySelector(".inline-label");o&&(o.innerHTML=o.innerHTML.replace(/(#\d+)/g,"#"+e))}r.p8.registerPlugin(a.L),d.prototype.__property=function(t){return function(e){const o=this.element.querySelector(t);if(void 0===e)return parseInt(o.value.toString());e=parseInt(e),isNaN(e)||(o.value=e)}},d.prototype.totalForms=d.prototype.__property('input[name$="-TOTAL_FORMS"]'),d.prototype.maxForms=d.prototype.__property('input[name$="-MAX_NUM_FORMS"]'),c.prototype.getRows=function(){return this.root.querySelectorAll("."+this.opts.formCssClass)},c.prototype.addRow=function(){let t=this.mgmt.totalForms();const e=this.mgmt.maxForms();if(t>=e)return null;const o=this.root.querySelector("."+this.opts.emptyCssClass);if(!o)throw new Error("template form not found");const n=o.cloneNode(!0),i=window.pageYOffset||document.documentElement.scrollTop;n.classList.remove(this.opts.emptyCssClass),o.parentNode.insertBefore(n,o),window.scrollTo({top:i}),"TR"!==n.tagName&&r.p8.from(n,{duration:this.opts.animationSpeed/1e3,height:0,clearProps:"all"}),this.mgmt.totalForms(++t),this.addButton.hidden=t>=e;const a=n.querySelector(this.opts.deleteButtonSelector);return a&&(a.hidden=!1),this.opts.onAdded&&this.opts.onAdded.call(this,n,this.opts.prefix,t),this.root.dispatchEvent(new CustomEvent("row-added",{detail:[n,this.opts.prefix]})),s.Z.dom.trigger("mutate",[n]),s.Z.inlines.trigger("added",[n,this.opts.prefix]),l(document).trigger("formset:added",[l(n),this.opts.prefix]),n},c.prototype.deleteRow=function(t){let e=this.mgmt.totalForms();const o=Array.from(this.getRows()),n=o.indexOf(t);if(this.opts.onRemove)for(let t=n+1;t<o.length;t++)this.opts.onRemove.call(this,o[t],this.opts.prefix,t);s.Z.dom.trigger("release",[t]),s.Z.inlines.trigger("remove",[t,this.opts.prefix]),"TR"!==t.tagName&&r.p8.to(t,{duration:this.opts.animationSpeed/1e3,height:0,onComplete:function(){t.parentNode.removeChild(t)}}),s.Z.inlines.trigger("removed",[t,this.opts.prefix]),this.root.dispatchEvent(new CustomEvent("row-removed",{detail:[t,this.opts.prefix]})),l(document).trigger("formset:removed",[l(t),this.opts.prefix]),this.mgmt.totalForms(--e),this.addButton.hidden=e>=this.mgmt.maxForms()},(0,n.Z)((function(t=document.body){t.querySelectorAll(".inline-group").forEach((function(t){switch(t.dataset.inlineType){case"stacked":new c(t,{prefix:t.dataset.inlinePrefix,onAdded:function(t,e,o){u(t,e,o),p(t,o)},onRemove:function(t,e,o){u(t,e,o),p(t,o)}});break;case"tabular":new c(t,{prefix:t.dataset.inlinePrefix,onAdded:function(t,e,o){u(t,e,o)},onRemove:function(t,e,o){u(t,e,o)}})}}))}));var m=o(2876),h=o(5317);function f(t,e){this.opts=Object.assign({speed:1,items:".item",moveUpBtn:".move-up",moveDownBtn:".move-down",disabledClass:"disabled",scrollWindow:!0,scrollMargin:{top:300,bottom:350},ignore:null,onChange:null},e),this.root=t,t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("update:sortbuttons",this.updateBounds.bind(this)),this.updateBounds()}r.p8.registerPlugin(a.L),f.prototype._onClick=function(t){const e=t.target,o=e.closest(this.opts.moveUpBtn);if(o&&this.root.contains(o)){if(o.classList.contains(this.opts.disabledClass))return;const e=o.closest(this.opts.items);return void(e&&(t.preventDefault(),t.stopPropagation(),this.moveUp(e)))}const n=e.closest(this.opts.moveDownBtn);if(n&&this.root.contains(n)){if(n.classList.contains(this.opts.disabledClass))return;const e=n.closest(this.opts.items);e&&(t.preventDefault(),t.stopPropagation(),this.moveDown(e))}},f.prototype._findNextItem=function(t){let e=t;for(;e;)if(this.opts.ignore&&e.matches(this.opts.ignore))e=e.nextElementSibling;else{if(e.matches(this.opts.items))break;e=e.nextElementSibling}return e},f.prototype._findPreviousItem=function(t){let e=t;for(;e;)if(this.opts.ignore&&e.matches(this.opts.ignore))e=e.previousElementSibling;else{if(e.matches(this.opts.items))break;e=e.previousElementSibling}return e},f.prototype.moveDown=function(t){const e=this._findNextItem(t.nextElementSibling);e&&this._swap(t,e)},f.prototype.moveUp=function(t){const e=this._findPreviousItem(t.previousElementSibling);e&&this._swap(e,t,!0)},f.prototype._swap=function(t,e,o=!1){const n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),s=t.style.cssText,r=e.style.cssText;this.disableItemButtons(t),this.disableItemButtons(e),e.after(t);const a=i.top-n.top-n.height;t.style.transform=`translate3d(0, ${-i.height-a}px, ${o?0:1}px)`,e.style.transform=`translate3d(0, ${i.top-n.top}px, ${o?1:0}px)`;const l=new h.Vq({onComplete:function(){t.style.cssText=s,e.style.cssText=r,this.updateBounds()}.bind(this)}).to(t,{duration:this.opts.speed,y:0,clearProps:"all"}).to(e,{duration:this.opts.speed,y:0,clearProps:"all"},0);if(this.opts.scrollWindow){const t=(window.pageYOffset||document.documentElement.scrollTop)+(o?n.top-i.top:i.top-n.top),e=this.opts.scrollMargin.top,s=window.innerHeight-this.opts.scrollMargin.bottom;let r=!0;r&=o?!(n.top>s&&i.top>s):!(n.top<e&&i.top<e),r&&l.to(window,{duration:this.opts.speed,scrollTo:{y:Math.max(0,t)}},0)}"function"==typeof this.opts.onChange&&this.opts.onChange.call(this,t,e)},f.prototype.disableItemButtons=function(t){const e=t.querySelector(this.opts.moveUpBtn),o=t.querySelector(this.opts.moveDownBtn);e.classList.add(this.opts.disabledClass),o.classList.add(this.opts.disabledClass)},f.prototype.updateBounds=function(){const t=this.root.querySelectorAll(this.opts.items);if(!t.length)return;t.forEach(function(t){const e=t.querySelector(this.opts.moveUpBtn),o=t.querySelector(this.opts.moveDownBtn);e.classList.remove(this.opts.disabledClass),o.classList.remove(this.opts.disabledClass)}.bind(this));const e=this._findNextItem(t[0]);if(e){const t=e.querySelector(this.opts.moveUpBtn);t&&t.classList.add(this.opts.disabledClass)}const o=this._findPreviousItem(t[t.length-1]);if(o){const t=o.querySelector(this.opts.moveDownBtn);t&&t.classList.add(this.opts.disabledClass)}};var g=f;(0,n.Z)((function(){document.querySelectorAll(".sortable-inline-group").forEach((function(t){const e=new g(t,{speed:"tabular"===t.dataset.inlineType?.25:.5,items:".sortable-item",moveUpBtn:".sortable-move-up",moveDownBtn:".sortable-move-down",ignore:".empty-form"});t.addEventListener("row-added",(function(){e.updateBounds()}))}))})),document.addEventListener("submit",(function(t){t.target.querySelectorAll(".sortable-inline-group").forEach((function(t){!function(t){let e=0;t.querySelectorAll(".sortable-item:not(.empty-form)").forEach((function(t){if(t.classList.contains("has_original")||m.Z.containsChangedField(t)){const o=t.querySelector(".sortable-input");o&&(o.value=e++)}}))}(t);const e=t._inline_formset,o="."+e.opts.formCssClass+":not(."+e.opts.emptyCssClass+")";t.querySelectorAll(o).forEach((function(t,o){!function(t,e,o){const n=new RegExp("("+e+"-(\\d+))"),i=e+"-"+o;t.querySelectorAll("*").forEach((function(t){t.htmlFor&&(t.htmlFor=t.htmlFor.replace(n,i)),t.id&&(t.id=t.id.replace(n,i)),t.name&&(t.name=t.name.replace(n,i))})),t.setAttribute("id",e+"-"+o)}(t,e.opts.prefix,o)}))}))}));o(8103);var w=o(9367),v=o.n(w),y=o(8948);function b(t=document.body){let e="textarea[autosize]";t.matches(e)&&v()(t),v()(t.querySelectorAll(e))}(0,n.Z)((function(){b(),y(document).on("shown.bs.tab",(function(t){const e=t.target.getAttribute("href"),o=e&&document.querySelector(e);o&&v().update(o.querySelectorAll("textarea[autosize]"))}))})),s.Z.dom.on("mutate",b),window.paperAdmin=window.paperAdmin||{},Object.assign(window.paperAdmin,{autosize:v()});var _=o(8948);r.p8.registerPlugin(a.L);(0,n.Z)((function(){const t=document.querySelectorAll(".invalid, .formset-errors, .formset-form-errors"),e=Array.from(t).find((function(t){return""!==t.innerHTML}));if(e){const t=e.getBoundingClientRect().top;t>50&&t<document.documentElement.clientHeight-50||setTimeout((function(){r.p8.to(window,{duration:.5,scrollTo:{y:t-Math.floor(document.documentElement.clientHeight/2),offsetY:-25}})}))}else{const t=location.hash.substr(1).replace(/-panel$/i,"-tab"),e=t&&document.querySelector("#"+t);e&&_(e).tab("show")}})),_(document).on("shown.bs.tab",(function(t){const e=t.target.getAttribute("aria-controls");if(e){history.replaceState(null,"","#"+e);const t=document.getElementById("changeform");if(t){const o=new URL(t.action);o.hash=e,t.action=o.toString()}}}));o(686);var E=o(8948);function S(t,e){e.closest(".empty-form")||E(e).select2(t)}function x(t=document.body){let e=".admin-autocomplete",o={ajax:{data:function(t){return{term:t.term,page:t.page}}}};t.matches(e)&&S(o,t),t.querySelectorAll(e).forEach(S.bind(null,o))}(0,n.Z)(x),s.Z.dom.on("mutate",x);o(9514);var C=o(4953),L=o.n(C);function A(t,e){e.closest(".empty-form")||L()(e,t)}function B(t=document.body){let e=".vDatePicker",o={altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d"};t.matches(e)&&A(o,t),t.querySelectorAll(e).forEach(A.bind(null,o));let n=".vTimePicker",i={allowInput:!0,enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0};t.matches(n)&&A(i,t),t.querySelectorAll(n).forEach(A.bind(null,i))}(0,n.Z)(B),s.Z.dom.on("mutate",B),document.addEventListener("wheel",(function(t){const e=t.target.closest(".numInputWrapper"),o=e&&e.querySelector("input");if(o){t.preventDefault();const e=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:t.deltaY>0?40:38});o.dispatchEvent(e)}}),{passive:!1}),document.addEventListener("click",(function(t){const e=t.target.closest(".vDateFieldTrigger"),o=e&&e.closest(".input-group"),n=o&&o.querySelector(".vDateInput");n&&n._flatpickr&&setTimeout((function(){n._flatpickr.open()}),0)}));o(2050),o(1990);var q=o(8948);function k(t){t.closest(".empty-form")||q(t).multiSelect()}function P(t=document.body){let e=".vMultiSelect";t.matches(e)&&k(t),t.querySelectorAll(e).forEach(k)}(0,n.Z)(P),s.Z.dom.on("mutate",P);o(712),o(6152);(0,n.Z)((function(){const t=document.getElementById("changeform");t&&(0,i.Z)(t),window.django_prepopulated_fields&&window.django_prepopulated_fields.length&&Promise.all([o.e(648),o.e(231)]).then(o.bind(o,7556))}))},8103:function(t,e,o){!function(t){"use strict";function e(t){return t=(t=t.replace(/\./g,"__dot__")).replace(/-/g,"__dash__")}function o(t){return t=(t=t.replace(/__dot__/g,".")).replace(/__dash__/g,"-")}function n(t,o,n){let i=t.id.replace(o,"");i=e(i);let s=t.href;n&&(-1===s.indexOf("?")?s+="?_popup=1":s+="&_popup=1");const r=void 0!==window.screenX?window.screenX:window.screenLeft,a=void 0!==window.screenY?window.screenY:window.screenTop,l=void 0!==window.outerWidth?window.outerWidth:document.body.clientWidth,d=void 0!==window.outerHeight?window.outerHeight:document.body.clientHeight,c=a+Math.round((d-600)/2),u=r+Math.round((l-940)/2);return window.open(s,i,"width=940,height=600,top="+c+",left="+u+",resizable=yes,scrollbars=yes").focus(),!1}function i(t){return n(t,/^lookup_/,!0)}function s(t){return n(t,/^(change|add|delete)_/,!1)}function r(e){const o=t(e),n=o.closest(".related-widget-wrapper").find(".view-related, .change-related, .delete-related");if(!n.length)return;const i=o.val();i?n.each((function(){const e=t(this);e.attr("href",e.attr("data-href-template").replace("__fk__",i))})):n.removeAttr("href")}function a(e,n,i){const s=o(e.name),r=document.getElementById(s);if(r){const e=r.nodeName.toUpperCase();"SELECT"===e?r.options[r.options.length]=new Option(i,n,!0,!0):"INPUT"===e&&(-1!==r.className.indexOf("vManyToManyRawIdAdminField")&&r.value?r.value+=","+n:r.value=n),t(r).trigger("change")}e.close()}window.id_to_windowname=e,window.windowname_to_id=o,window.showRelatedObjectLookupPopup=i,window.dismissRelatedLookupPopup=function(t,e){const n=o(t.name),i=document.getElementById(n);-1!==i.className.indexOf("vManyToManyRawIdAdminField")&&i.value?i.value+=","+e:document.getElementById(n).value=e,t.close()},window.showRelatedObjectPopup=s,window.updateRelatedObjectLinks=r,window.dismissAddRelatedObjectPopup=a,window.dismissChangeRelatedObjectPopup=function(e,n,i,s){const r=o(e.name).replace(/^edit_/,"");t("#"+r).find("option").each((function(){this.value===n&&(this.textContent=i,this.value=s)})),e.close()},window.dismissDeleteRelatedObjectPopup=function(e,n){const i=o(e.name).replace(/^delete_/,"");t("#"+i).find("option").each((function(){this.value===n&&t(this).remove()})).trigger("change"),e.close()},window.showAddAnotherPopup=s,window.dismissAddAnotherPopup=a,t(document).ready((function(){t("a[data-popup-opener]").on("click",(function(e){e.preventDefault(),opener.dismissRelatedLookupPopup(window,t(this).data("popup-opener"))})),t("body").on("click",".related-widget-wrapper-link",(function(e){if(e.preventDefault(),this.href){const e=t.Event("django:show-related",{href:this.href});t(this).trigger(e),e.isDefaultPrevented()||s(this)}})).on("change",".related-widget-wrapper select",(function(){const e=t.Event("django:update-related");t(this).trigger(e),e.isDefaultPrevented()||r(this)})).on("change",".related-widget-wrapper input",(function(){this.checked&&r(this)})).on("click",".related-lookup",(function(e){e.preventDefault();const o=t.Event("django:lookup-related");t(this).trigger(o),o.isDefaultPrevented()||i(this)})),t(".related-widget-wrapper select").trigger("change"),t(".related-widget-wrapper input:checked").trigger("change")}))}(o(8948))},2948:function(t,e,o){"use strict";function n(t){let e=!1,o=!1;t.addEventListener("submit",(function(){e=!0}));const n=gettext("You have unsaved changes");function i(){document.removeEventListener("keydown",i),document.removeEventListener("mousedown",i),t.addEventListener("change",(function e(n){t.removeEventListener("change",e);const i=n.target,s=i.closest(".form-widget");!(null!==i.closest('[data-hook-unload="prevent"]'))&&s&&t.contains(s)&&(o=!0)}))}window.addEventListener("beforeunload",(function(t){if(!e&&o)return t.returnValue=n,n})),document.addEventListener("keydown",i),document.addEventListener("mousedown",i)}o.d(e,{Z:function(){return n}})},9514:function(){document.addEventListener("change",(function(t){const e=t.target;if("INPUT"===e.tagName&&e.closest(".vClearableFileField")){let t=e.value.split("\\").pop(),o=e.nextElementSibling.querySelector("span");o&&(o.textContent=t||o.dataset.initialText)}})),document.addEventListener("focus",(function(t){const e=t.target;"INPUT"===e.tagName&&e.closest(".vClearableFileField")&&e.classList.add("focused")})),document.addEventListener("blur",(function(t){const e=t.target;"INPUT"===e.tagName&&e.closest(".vClearableFileField")&&e.classList.remove("focused")}))},2050:function(){document.addEventListener("input",(function(t){const e=t.target.closest(".vEmailInput"),o=e&&e.closest(".input-group"),n=o&&o.querySelector(".input-group-text");if(n){e.value.trim()?n.href="mailto:"+e.value:n.removeAttribute("href")}}))},712:function(){document.addEventListener("click",(function(t){const e=t.target.closest(".vPasswordTrigger");if(e){const t=e.closest(".input-group"),o=t&&t.querySelector("i.fa"),n=t&&t.querySelector("input");if(n){const t=["fa-eye-slash","fa-eye"],e=["text","password"],i=(e.indexOf(n.type)+1)%2;n.type=e[i],o.classList.add(t[i]),o.classList.remove(t[(i+1)%2])}}}))},6152:function(){document.addEventListener("input",(function(t){const e=t.target.closest(".vURLInput"),o=e&&e.closest(".input-group"),n=o&&o.querySelector(".input-group-text");if(n){let t=e.value.trim();t?n.href=t:n.removeAttribute("href")}}))}}]);
//# sourceMappingURL=changeform.chunk.min.js.map