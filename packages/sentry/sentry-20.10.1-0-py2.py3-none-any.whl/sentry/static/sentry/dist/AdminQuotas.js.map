{"version":3,"sources":["webpack:///./app/views/asyncView.tsx","webpack:///./app/components/internalStatChart.jsx","webpack:///./app/views/admin/adminQuotas.jsx"],"names":["AsyncView","title","this","getTitle","renderComponent","AsyncComponent","InternalStatChart","state","error","loading","data","fetchData","_nextProps","nextState","prevProps","since","props","stat","resolution","setState","api","request","method","key","success","map","x","y","onRetry","points","getChartPoints","className","label","height","React","Component","defaultProps","withApi","AdminQuotas","Date","getTime","config","value","backend","disabled","options"],"mappings":"4qBAQqBA,E,uIAKjB,MAAO,K,+BAIP,IAAMC,EAAQC,KAAKC,WACnB,OACE,YAAC,IAAD,CAAeF,MAAK,UAAKA,EAAQ,GAAH,OAAMA,EAAN,OAAmB,GAA7B,WACjBC,KAAKE,uB,GATJC,KAHWL,E,yoBCAfM,E,kLAcJC,MAAQ,CACNC,OAAO,EACPC,SAAS,EACTC,KAAM,M,0DAINR,KAAKS,c,4CAGeC,EAAYC,GAChC,OAAOX,KAAKK,MAAME,UAAYI,EAAUJ,U,yCAGvBK,GAEfA,EAAUC,QAAUb,KAAKc,MAAMD,OAC/BD,EAAUG,OAASf,KAAKc,MAAMC,MAC9BH,EAAUI,aAAehB,KAAKc,MAAME,YAEpChB,KAAKS,c,kCAIG,WACVT,KAAKiB,SAAS,CAACV,SAAS,IACxBP,KAAKc,MAAMI,IAAIC,QAAQ,mBAAoB,CACzCC,OAAQ,MACRZ,KAAM,CACJK,MAAOb,KAAKc,MAAMD,MAClBG,WAAYhB,KAAKc,MAAME,WACvBK,IAAKrB,KAAKc,MAAMC,MAElBO,QAAS,SAAAd,GAAI,OACX,EAAKS,SAAS,CACZT,OACAD,SAAS,EACTD,OAAO,KAEXA,MAAO,kBAAM,EAAKW,SAAS,CAACX,OAAO,S,uCAKrC,OAAON,KAAKK,MAAMG,KAAKe,KAAI,iCAAa,CAACC,EAAd,KAAiBC,EAAjB,W,+BAI3B,OAAIzB,KAAKK,MAAME,QACN,YAAC,UAAD,MACEP,KAAKK,MAAMC,MACb,YAAC,IAAD,CAAcoB,QAAS1B,KAAKS,YAInC,YAAC,IAAD,CACEkB,OAAQ3B,KAAK4B,iBACbC,UAAU,oBACVC,MAAO9B,KAAKc,MAAMgB,MAClBC,OAAQ/B,KAAKc,MAAMiB,a,GAzEKC,IAAMC,WAAhC7B,E,gCAAAA,EAUG8B,aAAe,CACpBH,OAAQ,KAoEGI,gBAAQ/B,I,+3BCjFFgC,E,8IAEjB,O,iWAAA,6DAEEvB,OAAO,IAAIwB,MAAOC,UAAY,IAAO,OACrCtB,WAAY,S,qCAKd,MAAO,CAAC,CAAC,SAAU,wB,mCAGR,IACJuB,EAAUvC,KAAKK,MAAfkC,OACP,OACE,uBACE,gCAEA,mBAAKV,UAAU,OACb,mBAAKA,UAAU,cACb,iCAGF,mBAAKA,UAAU,4BACb,YAAC,YAAD,CAAWW,MAAOD,EAAOE,QAASX,MAAM,UAAUY,UAAQ,IAC1D,YAAC,YAAD,CACEF,MAAOD,EAAOI,QAAQ,qBACtBb,MAAM,aACNY,UAAQ,MAKd,mBAAKb,UAAU,OACb,mBAAKA,UAAU,cACb,uCAEF,YAAC,IAAD,CACEhB,MAAOb,KAAKK,MAAMQ,MAClBG,WAAYhB,KAAKK,MAAMW,WACvBD,KAAK,eACLe,MAAM,YAIV,mBAAKD,UAAU,OACb,mBAAKA,UAAU,cACb,yCAEF,YAAC,IAAD,CACEhB,MAAOb,KAAKK,MAAMQ,MAClBG,WAAYhB,KAAKK,MAAMW,WACvBD,KAAK,iBACLe,MAAM,iB,GAtDuBhC","file":"AdminQuotas.js","sourcesContent":["import DocumentTitle from 'react-document-title';\nimport React from 'react';\n\nimport AsyncComponent from 'app/components/asyncComponent';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    const title = this.getTitle();\n    return (\n      <DocumentTitle title={`${title ? `${title} - ` : ''}Sentry`}>\n        {this.renderComponent()}\n      </DocumentTitle>\n    );\n  }\n}\n","import PropTypes from 'prop-types';\nimport React from 'react';\n\nimport BarChart from 'app/components/barChart';\nimport LoadingError from 'app/components/loadingError';\nimport LoadingIndicator from 'app/components/loadingIndicator';\nimport withApi from 'app/utils/withApi';\n\nclass InternalStatChart extends React.Component {\n  static propTypes = {\n    api: PropTypes.object.isRequired,\n    since: PropTypes.number.isRequired,\n    resolution: PropTypes.string.isRequired,\n    stat: PropTypes.string.isRequired,\n    label: PropTypes.string,\n    height: PropTypes.number,\n  };\n\n  static defaultProps = {\n    height: 150,\n  };\n\n  state = {\n    error: false,\n    loading: true,\n    data: null,\n  };\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  shouldComponentUpdate(_nextProps, nextState) {\n    return this.state.loading !== nextState.loading;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.since !== this.props.since ||\n      prevProps.stat !== this.props.stat ||\n      prevProps.resolution !== this.props.resolution\n    ) {\n      this.fetchData();\n    }\n  }\n\n  fetchData() {\n    this.setState({loading: true});\n    this.props.api.request('/internal/stats/', {\n      method: 'GET',\n      data: {\n        since: this.props.since,\n        resolution: this.props.resolution,\n        key: this.props.stat,\n      },\n      success: data =>\n        this.setState({\n          data,\n          loading: false,\n          error: false,\n        }),\n      error: () => this.setState({error: true}),\n    });\n  }\n\n  getChartPoints() {\n    return this.state.data.map(([x, y]) => ({x, y}));\n  }\n\n  render() {\n    if (this.state.loading) {\n      return <LoadingIndicator />;\n    } else if (this.state.error) {\n      return <LoadingError onRetry={this.fetchData} />;\n    }\n\n    return (\n      <BarChart\n        points={this.getChartPoints()}\n        className=\"standard-barchart\"\n        label={this.props.label}\n        height={this.props.height}\n      />\n    );\n  }\n}\n\nexport default withApi(InternalStatChart);\n","import React from 'react';\n\nimport AsyncView from 'app/views/asyncView';\nimport {TextField} from 'app/components/forms';\nimport InternalStatChart from 'app/components/internalStatChart';\n\nexport default class AdminQuotas extends AsyncView {\n  getDefaultState() {\n    return {\n      ...super.getDefaultState(),\n      since: new Date().getTime() / 1000 - 3600 * 24 * 7,\n      resolution: '1h',\n    };\n  }\n\n  getEndpoints() {\n    return [['config', '/internal/quotas/']];\n  }\n\n  renderBody() {\n    const {config} = this.state;\n    return (\n      <div>\n        <h3>Quotas</h3>\n\n        <div className=\"box\">\n          <div className=\"box-header\">\n            <h4>Config</h4>\n          </div>\n\n          <div className=\"box-content with-padding\">\n            <TextField value={config.backend} label=\"Backend\" disabled />\n            <TextField\n              value={config.options['system.rate-limit']}\n              label=\"Rate Limit\"\n              disabled\n            />\n          </div>\n        </div>\n\n        <div className=\"box\">\n          <div className=\"box-header\">\n            <h4>Total Events</h4>\n          </div>\n          <InternalStatChart\n            since={this.state.since}\n            resolution={this.state.resolution}\n            stat=\"events.total\"\n            label=\"Events\"\n          />\n        </div>\n\n        <div className=\"box\">\n          <div className=\"box-header\">\n            <h4>Dropped Events</h4>\n          </div>\n          <InternalStatChart\n            since={this.state.since}\n            resolution={this.state.resolution}\n            stat=\"events.dropped\"\n            label=\"Events\"\n          />\n        </div>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}